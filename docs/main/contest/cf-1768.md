---
layout: page
title: CF 1768
parent: Contest
math: true
---

## C

You are given list $a$ of $n$ integers.

Find two permutations $p, q$ such that $a_i = \max(p_i, q_i)$ for all $i \in [1, n]$.

Constraints:
- $1 \le n \le 10^5$
- $1 \le a_i \le n$
- $p, q$ are permutations of $1$ to $n$

**Solution**

Let $f_x$ be the frequency of $x$ in $a$.

Since all $a_i$ come from either $p$ or $q$, we can never
have more than $2$ instances of some number. So,
$f_x \gt 2$ for some $x \in [1, n]$ yields no solution.

For some $x$, let $S_x$ be the multiset containing all $a_i \le x$.

If $\vert S_x \vert \gt x$, there is no solution because maximum
size of the multiset containing all $p_i, q_i$ for all $a_i \le x$
will is $2x$ as all values are in $[1, x]$ and there
are at most 2 occurrences of each.

Let us analyse $x$ from $1$ to $n$:
- If there are no occurences of $x$ in $a$, then we can
  use $x$ with some greater number.
- If there is a single occurence of $x$, say $x = a_i$ then
  we can set $p_i = q_i = x$
- If there are two occurences of $x$, say $x = a_i = a_j$, then
  and we will need two instances of some $z \lt x$.
  - Since it holds that $\vert S_x \vert \le x$, we have $\vert S_{x-1} \vert \le x - 2$
    this means there exists some $z$ in $[1, x-1]$ that doesn't occur in $a$.
    We can use two instances $z$ then.
  - We can show that such operation doesn't affect greater values of $x$.
    Suppose we replace an $x$ in $S_x$ (there will be two instances) with a $z$.
    Then, this doesn't change size of any of $\vert S_y \vert$ where $y \gt x$
    and we make sure that $z$ is not used again.

***

## D

You are given a permutation $p$ of $1$ to $n$.
In one operation, you can choose $i, j \in [1, n]$ and
swap $p_i, p_j$.

Find minimum number of operations such that $p$ has exactly
one inversion.

Constraints:
- $1 \le n \le 10^5$

**Solution**

Notice that there can be a single inversion, when going back from
a sorted permutation, when we swap two adjacent elements.

We can view the permutation as an iterated function. Then
we will have some independent cycles.
In case of sorting, we need to get $n$ independent cycles.
Each swap operation changes the number of cycles by $1$.

Let $K$ be the minimum number of operations required to sort $p$.

Now suppose we wrap $i, i+1$ under new names $i+1, i$ (and in final state we will unwrap).
Then, the number of cycles increases by one if these were initially in
the same cycle and decreases by one if they were initially in different cycles.

If there exists some $i$ where number of cycles increases by one,
we report answer $K-1$.

Otherwise, the answer is $K+1$.

> See sorting a permutation with swaps

***